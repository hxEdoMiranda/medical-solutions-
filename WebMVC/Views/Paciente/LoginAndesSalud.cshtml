@using Microsoft.AspNetCore.Http.Extensions
@model LoginViewModel

@{
    Layout = null;

}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    @*<title>@ViewData["Title"] - Medical</title>*@

    <base href="">
    <meta charset="utf-8" />
    <title>Medical | Sitio Paciente</title>
    <meta name="description" content="Latest updates and statistic charts">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-227236350-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-227236350-1');
    </script>

    <!-- Google Tag Manager -->
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-T3GQHL7');
    </script>
    <!-- End Google Tag Manager -->
    <!-- #region metronic-template -->
    <!--begin::Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Mulish&display=swap" rel="stylesheet">

    <!--end::Fonts -->

    <link href="~/metronic_demo7/assets/css/pages/login/login-3.css?rnd=@NumeroRandom.GetRandom()" rel="stylesheet" type="text/css" />

    <!--begin::Global Theme Styles(used by all pages) -->
    <link href="~/metronic_demo7/assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
    <link href="~/metronic_demo7/assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
    <!--end::Global Theme Styles -->
    <!--begin::Global Medismart Styles -->
    <link href="~/css/Medismart/main.css?rnd=@NumeroRandom.GetRandom()" rel="stylesheet" type="text/css" />

    <link href="~/css/andes-salud/andes-salud.css?rnd=@NumeroRandom.GetRandom()" rel="stylesheet" type="text/css" />

    @*<link href="~/css/colmena/colmena.css?rnd=@NumeroRandom.GetRandom()" rel="stylesheet" type="text/css" />*@
    <!--end::Global Medismart Styles -->
    <!-- #endregion -->
    @if (Context.Request.GetEncodedUrl().ToUpper().Contains("ABODOC"))
    {
        <link rel="shortcut icon" href="~/img/abodoc/favicon.ico" />
        <link href="~/css/abodoc/abodoc.css?rand=@NumeroRandom.GetRandom()" rel="stylesheet" />
    }


    <script>
        (function (h, o, t, j, a, r) {
            h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
            h._hjSettings = { hjid: 2677023, hjsv: 6 };
            a = o.getElementsByTagName('head')[0];
            r = o.createElement('script'); r.async = 1;
            r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
            a.appendChild(r);
        })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
    </script>
</head>
<body class="kt-quick-panel--right kt-demo-panel--right kt-offcanvas-panel--right kt-header--fixed kt-header-mobile--fixed kt-subheader--enabled kt-subheader--transparent kt-aside--enabled kt-aside--fixed kt-aside--minimize kt-page--loading">

    <!-- Google Tag Manager (noscript) -->

    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T3GQHL7"
                height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
      <!-- End Google Tag Manager (noscript) -->
    <!-- begin:: Page -->
    <div class="kt-grid kt-grid--ver kt-grid--root kt-page">
        <div class="kt-grid kt-grid--hor kt-grid--root  kt-login kt-login--v3 kt-login--signin" id="kt_login">
            <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor">
                <div class="kt-login__logo mb-0 d-md-none d-block text-center cont-logo-mobile">
                    <a href="#" class="px-0 logotipo-img logotipo-mobile">
                        <!--<img alt="Logo" class="logotipo" src="~/img/logotipo.png" />-->
                    </a>
                </div>
                <div class="container-fluid container-login">
                    <div class="row d-flex ">
                        <div class="col-md-6 bkg-login d-none d-md-block">
                            <div id="imgLogin" class="imgLogin"></div>
                            <!--<img alt="Medismart.live" src="~/img/login6.png" id="imgLogin" />-->
                            <!--<img src="~/img/login4.jpg" alt="Medismart.live"/>-->
                        </div>
                        <div class="col col-md-6">

                            <div class="kt-login__wrapper">

                                <div class="kt-login__container fletcher_login">

                                    <div class="kt-login__logo mb-0 d-none d-md-block">
                                        <a href="#" class="px-0 logotipo-img logotipo-desktop">
                                            <!--<img alt="Logo" class="logotipo" src="~/img/logotipo.png" />-->
                                        </a>
                                    </div>
                                    <div class="kt-login__signin">
                                        @*
                                        <form class="kt-form" method="post" role="form">
                                        <div class="form-group">

                                        <div class="kt-login__actions mt-0">

                                        <div class="kt-login__head">
                                        <h3 class="kt-login__title">Ingresa tu código promocional</h3>
                                        </div>

                                        <div class="input-group">
                                        <input type="text" class="form-control" placeholder="Ingresa tu código" aria-label="Código promocional" asp-for="CodigoProm" aria-describedby="Ingresa tu código">
                                        <div class="input-group-append">
                                        <button id="kt_codigo_submit" class="btn btn-valida-codigo" type="button">Canjear Código</button>

                                        </div>
                                        </div>
                                        <div id="alert-code" class="alert alert-danger alert-dismissible d-none" role="alert">
                                        <div id="errMessageCode" class="alert-text"></div>
                                        </div>
                                        </div>
                                        </div>
                                        </form>
                                        *@
                                        <div class="kt-login__head">
                                            <h3 class="kt-login__title">Ingreso de Usuario </h3>
                                        </div>


                                        <form class="kt-form" asp-controller="Account" asp-action="Login" method="post" role="form">
                                            <div class="form-group mb-3">
                                                <label class="d-block ms-label fuente-accesible" id="labelIdentificador">Rut</label>
                                                <input class="form-control" type="text" id="kt_rut" placeholder="11111111-1" autocomplete="off" name="username" asp-for="Username">
                                                <input class="form-control" type="hidden" id="JsonData" asp-for="JsonData">
                                            </div>
                                            <div class="form-group">
                                                <label class="d-block ms-label fuente-accesible">Clave</label>
                                                <input class="form-control" type="password" placeholder="Clave" asp-for="Password">
                                            </div>
                                            <input hidden name="rol" value="@Roles.Paciente" />
                                            <input hidden name="returnUrl" value="@ViewData["ReturnUrl"]" />
                                            <div class="row kt-login__extra_02 align-items-center mt-0">
                                                <div class="col-5">
                                                    <a href="javascript:;" id="kt_login_forgot" class="fuente-accesible">¿Olvidaste tu clave?</a>
                                                </div>

                                                <div class="col-7">
                                                    <div class="kt-login__actions mt-0">
                                                        @*<button type="submit" class="btn btn-default">Log in</button>*@
                                                        <button id="kt_login_signin_submit" class="btn btn-primary btn-elevate kt-login__btn-primary btn-block mt-0 fuente-accesible">Ingresar</button>
                                                    </div>
                                                </div>
                                            </div>                                    
                                        </form>
                                    </div>
                                    <div class="kt-login__forgot">
                                        <div class="kt-login__head">
                                            <h3 class="kt-login__title">¿Olvidaste tu clave?</h3>
                                        </div>
                                        <form class="kt-form" asp-controller="Account" asp-action="PageReset" method="post">

                                            <div class="form-group mb-3">
                                                <label class="d-block ms-label fuente-accesible" id="labelIdentificador">Rut</label>
                                                <input class="form-control" type="text" id="kt_rut" placeholder="111111111 o tucorreo@gmail.com" autocomplete="off" asp-for="Username">
                                                <input class="form-control" type="hidden" id="JsonData" asp-for="JsonData">
                                                <input hidden name="rol" value="@Model.rol" />
                                            </div>
                                            <div class="kt-login__actions mt-0">
                                                <div class="container">
                                                    <div class="row">
                                                        <div class="col-12 col-md px-0 pr-md-1">
                                                            <button id="kt_login_forgot_cancel" class="btn btn-light btn-elevate kt-login__btn-secondary btn-block mb-3 mb-md-0">Cancelar</button>
                                                        </div>
                                                        <div class="col-12 col-md px-0 pl-md-1">
                                                            <button id="kt_login_forgot_submit" class="btn btn-primary btn-elevate kt-login__btn-primary btn-block">Reiniciar clave</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>

                                    <div class="kt-reset__password">
                                        <div class="kt-login__head">
                                            <h3 class="kt-login__title">Ingresa tu nueva clave</h3>
                                        </div>
                                        <form class="kt-form" method="post" role="form">

                                            <div class="input-group mb-2">
                                                <input class="form-control" type="password" placeholder="Clave" asp-for="Password">
                                            </div>
                                            <div class="input-group mb-3">
                                                <input class="form-control" type="password" placeholder="Repetir Clave" asp-for="RepeatPassword">
                                            </div>
                                            <input hidden name="rol" value="@Model.rol" />
                                            <input hidden name="ActivationCode" value="@Model.ActivationCode" />
                                            <input hidden name="username" value="@Model.Username" />
                                            <input hidden name="returnUrl" value="@ViewData["ReturnUrl"]" />
                                            <div class="text-left">
                                                <p style="font-size:12px !important">
                                                    <strong>La clave debe tener :</strong><br /><br />
                                                    - Entre 8 a 15 caracteres. <br />
                                                    - Al menos una letra mayúscula / Al menos una letra minúscula / Al menos un número <br />
                                                </p>
                                            </div>
                                            <div class="kt-login__actions mt-0">
                                                @*<button type="submit" class="btn btn-default">Log in</button>*@
                                                <button id="kt_password_reset_submit" class="btn btn-brand btn-elevate kt-login__btn-primary">Modificar</button>
                                            </div>
                                        </form>
                                    </div>
                                    <!-- begin:: No Account-->
                                    <div class="kt-login__signin">
                                        <div class="kt-login__head head-crear-usuario">
                                            <h4>Si no tienes una cuenta, <span class="registrate-aqui">regístrate aquí:</span></h4>
                                        </div>
                                        <form class="kt-form" method="post" role="form">
                                            <div class="form-group">

                                                <div class="kt-login__actions mt-0">
                                                    <div class="input-group">
                                                        <div class="input-group-append">
                                                            <button id="open_modal_concentimiento" class="btn btn-secondary btn-valida-codigo" type="button">Crear usuario</button>

                                                        </div>
                                                        
                                                    </div>
                                                    <div id="alert-code" class="alert alert-danger alert-dismissible d-none" role="alert">
                                                        <div id="errMessageCode" class="alert-text"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>

                                    </div>


                                    <div class="accesible-tools d-block">
                                        <div class="accesible-btn text-center">
                                            <button id="increase-font">A+</button>
                                            <button id="normal-font">A</button>
                                            <button id="decrease-font">A-</button>
                                        </div>
                                    </div>

                                    <!-- end:: No Account-->
                                    <!--begin::Divider-->
                                    <div class="kt-login__divider mt-5 convenioChile">

                                    <!--end:: Crear Usuario-->
                                    <!--begin::Divider-->

                                        <div class="kt-divider divider-medismart">
                                            <span></span>
                                            <span>Atendemos por Isapre y Fonasa</span>
                                            <span></span>
                                        </div>
                                    </div>

            
                                    <!--end::Divider-->
                                    <!--Convenios chile-->
                                    <div class="logo-convenios convenioChile">
                                        <div class="logos-andes">
                                            <div class="webpay">
                                                <img alt="Logo" src="~/img/webpay.png" />
                                            </div>
                                            <div class="fonasa">
                                                <img alt="Logo" src="~/img/fonasa.svg" />
                                            </div>
                                        </div>
                                        
                                    </div>

                                    <hr />

                                    <div class="kt-footer  kt-grid__item kt-grid kt-grid--desktop kt-grid--ver-desktop login-footer" id="kt_footer">
                                        <div class="kt-container  kt-container--fluid ">

                                            <div class="terminos">
                                                <a href="#" id="terminosFooter">Términos y condiciones</a>
                                                <a href="#" id="politicas">Políticas de privacidad</a>
                                            </div>
                                            <div class="kt-footer__copyright d-block">
                                                2022&nbsp;&copy;&nbsp;<a href="#" target="_blank" class="kt-link">Medical</a>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>

                </div>


            </div>
        </div>
    </div>


    <div class="modal" id="myModal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Tu e-email está asociado a los siguientes usuarios:</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body text-center">
                    <table width="100%" style="margin-top: 30px;margin-bottom: 30px" id="tablaUsuarios">
                        <tr>
                            <td>Nombre Usuario</td>
                            <td><button type="button" class="btn btn-primary">Seleccionar</button></td>
                        </tr>
                    </table>
                </div>

            </div>
        </div>
    </div>

    <!--Modal Terminos-->

    <div class="modal fade" id="modalTerminos" data-backdrop="static" name="kt_modal_3" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Términos y condiciones</h5>
                    <button type="button" class="close " data-dismiss="modal" aria-label="Close"><i class="fal fa-times"></i></button>
                </div>
                <div class="modal-body" id="modalTerminosBody">
                    @*terminos y condiciones se cargan de forma dinamica*@
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="btnCerrar" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>

    </div>

    <!--Modal Politicas-->

    <div class="modal fade" id="modalPoliticas" data-backdrop="static" name="kt_modal_3" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Políticas de privacidad</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="fal fa-times"></i></button>
                </div>
                <div class="modal-body" id="modalPoliticasBody">
                    @*politicas de privacidad se cargan de forma dinamica*@
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="btnCerrar" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>

    </div>
    <!--Inicio modal consentimiento-->
    <div class="modal fade modal-consentimiento" id="modalConsentimiento" tabindex="-1" aria-labelledby="consentimientoLabel" aria-hidden="true">
        <div class="modal-dialog dialog-cons">
            <div class="modal-content content-cons">
                <div class="modal-header header-cons">
                    
                    <button type="button" class="close-cons" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true" >&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                   
                    <h1 class="mod-cons-title">Consentimiento Informado Paciente</h1>
                    <p class="mod-cons-p">
                        El presente portal de atención médica online es operado por Medical Solutions SpA en colaboración con distintas entidades de salud. El uso de la plataforma considera que estoy en conocimiento y acuerdo de sus términos y condiciones de uso, así como de los deberes y derechos del paciente dispuestos por el MINSAL, debiendo ambos documentos ser leídos y expresamente aceptados al momento de agendar una teleconsulta.
                    </p>
                    <p class="mod-cons-p">
                        Al mismo tiempo, y en consideración a las alianzas colaborativas celebradas por Medical Solutions SpA, operador del presente portal de telemedicina, doy mi consentimiento para que este último haga entrega y uso de mis datos personales y ficha clínica, a todas las entidades debidamente acreditadas ante la Superintendencia de Salud, con el fin de apoyarlo en sus tratamientos y continuidad de atención de salud.
                    </p>
                    <p class="mod-cons-p">
                        Finalmente, entiendo que mis datos serán tratados con el más absoluto cuidado, tomándose siempre todas las medidas necesarias para su resguardo y privacidad.
                    </p>
                    <p class="mod-cons-p">
                        El tiempo de permanencia de mis datos personales será el estipulado por el Art. 13 de la ley 20.584 en concordancia con la ley 19.628 sobre protección de la vida privada.

                    </p>

                    <div class="mod-cons-btns">
                        <div><button class="btn-no-acepto" type="button" data-dismiss="modal" aria-label="Close">NO ACEPTO</button></div>
                        <div><button class="btn-acepto" id="kt_email_submit" type="button">ACEPTAR</button></div>

                    </div>
                </div>
                
            </div>
        </div>
    </div>
    <!--Fin modal consentimiento-->
    <!--Inicio modal crear cuenta-->
    <div class="modal fade modal-crear-cuenta" id="modalCrearCuenta" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">

                    <div>
                        Crea tu cuenta
                    </div>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!--Formulario cuenta-->

                    <form class="form-cuenta">
                        <div id="div-alert" class="alert alert-danger alert-dismissible d-none" role="alert">
                            <div id="errMessage" class="alert-text"></div>
                        </div>
                        <div id="div-alert-succes" class="alert alert-success alert-dismissible d-none" role="alert">
                            <div id="successMessage" class="alert-text"></div>
                        </div>
                        <div class="form-group">
                            <label for="rutCuenta">RUT</label>
                            <input type="text" class="form-control" id="rutCuenta" aria-describedby="rutCuenta" placeholder="Ingresa tu RUT">
                        </div>
                        <div class="form-group">
                            <label for="exampleInputEmail1">Nombres</label>
                            <input type="text" class="form-control" id="nombreCuenta" aria-describedby="nombrecuenta" placeholder="Ingresa tus nombres">
                        </div>
                        <div class="form-group">
                            <label for="exampleInputEmail1">Apellidos </label>
                            <input type="text" class="form-control" id="apellidoCuenta" aria-describedby="apellidocuenta" placeholder="Ingresa Apellido Paterno">
                        </div>
                        <div class="form-group">
                            <label for="correoCuenta">Correo</label>
                            <input type="email" class="form-control" id="correoCuenta" aria-describedby="correoCuenta" placeholder="Ingresa tu correo">
                        </div>

                    </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="btnCrearCuenta" class="btn btn-primary btn-sm">Crear</button>
            </div>
        </div>
    </div>
</div>
    <!--End:: Modal Crear Cuenta-->
    <!--End:: Modal Crear Cuenta-->
    <!-- #region metronic-template -->
    <!-- begin::Global Config(global config for global JS sciprts) -->
    <script>
        var KTAppOptions = {
            "colors": {
                "state": {
                    "brand": "#22b9ff",
                    "light": "#ffffff",
                    "dark": "#282a3c",
                    "primary": "#5867dd",
                    "success": "#34bfa3",
                    "info": "#36a3f7",
                    "warning": "#ffb822",
                    "danger": "#fd3995"
                },
                "base": {
                    "label": ["#c5cbe3", "#a1a8c3", "#3d4465", "#3e4466"],
                    "shape": ["#f0f3ff", "#d9dffa", "#afb4d4", "#646c9a"]
                }
            }
        };
    </script>

    <script>
        function manejarModalConcentimiento() {            
            document.getElementById('open_modal_concentimiento').addEventListener('click', function () {
                $('#modalConsentimiento').modal('show');
            });            
            document.getElementById('kt_email_submit').addEventListener('click', function () {
                $('#modalConsentimiento').modal('hide'); 
                $('#modalConsentimiento').on('hidden.bs.modal', function () {
                    $('#modalCrearCuenta').modal('show'); 
                    $(this).off('hidden.bs.modal');
                });
            });

            document.getElementById('rutCuenta').addEventListener('input', function (e) {
                let input = e.target;
                let value = input.value.replace(/\./g, ''); // Elimina los puntos

                if (/^\d{1,8}-[\dkK]$/.test(value)) {
                    input.classList.remove('error');
                } else {
                    input.classList.add('error');
                }

                input.value = value;
            });
        }

        manejarModalConcentimiento();
    </script>

    <script>

        document.addEventListener('DOMContentLoaded', function () {
            const rutInput = document.getElementById('kt_rut');

            rutInput.addEventListener('input', function (event) {
                let rutValue = event.target.value.trim();
                rutValue = rutValue.replace(/-/g, '');
                if (rutValue.length > 1) {
                    rutValue = rutValue.substring(0, rutValue.length - 1) + '-' + rutValue.charAt(rutValue.length - 1);
                }
                event.target.value = rutValue;
            });
        });
    </script>

    <!-- end::Global Config -->
    <!--begin::Global Theme Bundle(used by all pages) -->
    <script src="~/metronic_demo7/assets/plugins/global/plugins.bundle.js" type="text/javascript"></script>

    <script src="https://cdn.jsdelivr.net/gh/bigdatacloudapi/js-api-client@latest/bigdatacloud_api_client.min.js" type="text/javascript"></script>

    <script src="https://cdn.jsdelivr.net/gh/bigdatacloudapi/js-client-ip-client@latest/bigdatacloud_client_ip.min.js" type="text/javascript"></script>

    <script src="~/metronic_demo7/assets/js/scripts.bundle.js" type="text/javascript"></script>
    <script src="~/js/jquery.rut.js?rnd=@NumeroRandom.GetRandom()"></script>
    <!--end::Global Theme Bundle -->
    <!-- #endregion -->

    <script src="~/metronic_demo7/assets/js/pages/custom/login/login-general.js?rnd=@NumeroRandom.GetRandom()" type="text/javascript"></script>

    <script src="~/metronic_demo7/assets/js/pages/custom/login/login-prueba.js?rnd=@NumeroRandom.GetRandom()" type="module"></script>
    <script src="~/js/validator-messages-es.js"></script> <!-- traducción del validador -->
    <script src="~/js/random-image.js"></script><!-- random image login -->
    <script src="~/js/accesible.js"></script>
    <script src="~/js/terminos.js"></script>
    

</body>
</html>
